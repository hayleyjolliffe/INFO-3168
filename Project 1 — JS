/*

    INFO-3168 - Project 1
    Major League Baseball Form (v1.0)
    Due: 10 Mar. 22

    Hayley_Project1.js
    
    Hayley Jolliffe - [redacted]

*/
// Creating $gel function to reduce typing
function $gel(id) {
    return document.getElementById(id);
}

var year = parseInt($gel("year").value);
var month = parseInt($gel("month").value);
var day = parseInt($gel("day").value);

// Creating function for refreshing date
function refresh() {
    year = parseInt($gel("year").value);
    month = parseInt($gel("month").value);
    day = parseInt($gel("day").value);
}

// Creating AJAX function
const ISOK = 200;
let request = new XMLHttpRequest();

function asyncJSON(url) {
    // Creating event handler
    request.onload = function() {
        if (request.status === ISOK) {
            var object = JSON.parse(request.responseText);

            var jsonHomeTeam = object.data.games.game[0].home_team_name;
            var jsonAwayTeam = object.data.games.game[0].away_team_name;
            var jsonWinningPitcher = (object.data.games.game[0].winning_pitcher.first + " " + object.data.games.game[0].winning_pitcher.last);
            var jsonLosingPitcher = (object.data.games.game[0].losing_pitcher.first + " " + object.data.games.game[0].losing_pitcher.last);
            var jsonVenue = object.data.games.game[0].venue;

            // Clear text boxes
            $gel("homeTeam").value = "";
            $gel("awayTeam").value = "";
            $gel("winningPitcher").value = "";
            $gel("losingPitcher").value = "";
            $gel("venue").value = "";
            
            // Putting game data into textboxes
            $gel("homeTeam").value = jsonHomeTeam;
            $gel("awayTeam").value = jsonAwayTeam;
            $gel("winningPitcher").value = jsonWinningPitcher;
            $gel("losingPitcher").value = jsonLosingPitcher;
            $gel("venue").value = jsonVenue;

        }
    };
    request.open("GET", url, true);
    request.send();
}

function asyncData() {
    year = parseInt($gel("year").value);
    month = parseInt($gel("month").value);
    day = parseInt($gel("day").value);

    // Validating date inputs
    var tempMonth;
    var tempDay;

    if (month < 10) {
        tempMonth = "0" + month;
    }
    else {
        tempMonth = month;
    }
    if (day < 10) {
        tempDay = "0" + day;
    }
    else {
        tempDay = day;
    }

    var tempURL = "https://gd2.mlb.com/components/game/mlb/year_" + year + "/month_" + tempMonth + "/day_" + tempDay + "/master_scoreboard.json";
    
    asyncJSON(tempURL);
}

// Creating 'Previous Game' functino
function previous() {
    var newYear = year - 1;
    var newMonth = month - 1;
    var newDay = day - 1;

    // Validating date inputs
    var newTempMonth;
    var newTempDay;

    if (month < 10) {
        newTempMonth = "0" + month;
    }
    else {
        newTempMonth = month;
    }
    if (day < 10) {
        newTempDay = "0" + month;
    }
    else {
        newTempDay = day;
    }

    var newTempURL = "https://gd2.mlb.com/components/game/mlb/year_" + year + "/month_" + newTempMonth + "/day_" + newTempDay + "/master_scoreboard.json";

    asyncJSON(newTempURL);
}

// Creating 'Next Game' function
function next() {

}

// Creating 'Save Changes' function
function save() {

}
